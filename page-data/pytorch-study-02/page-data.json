{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/pytorch-study-02/",
    "result": {"data":{"cur":{"id":"05dedd7b-56a0-5b33-a2b8-831eeec7520a","html":"<h2 id=\"1-matplotlib\" style=\"position:relative;\"><a href=\"#1-matplotlib\" aria-label=\"1 matplotlib permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Matplotlib</h2>\n<p>NumPy 라이브러리를 활용하여 그래프를 만들어 시각화할 수 있는 라이브러리이다.</p>\n<p>지난번 NumPy에 대한 기본적인 설명은 여기에! 👇🏼</p>\n<p><a href=\"https://sunkyoung.github.io/pytorch-study-01/\">https://sunkyoung.github.io/pytorch-study-01/</a></p>\n<ul>\n<li>How to use ?</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np</code></pre></div>\n<ul>\n<li>Basic usage\n<ul>\n<li>plt.plot(x-axis, y-axis) : 주어진 x축, y축 데이터를 바탕으로 선형 그래프를 그림</li>\n<li>plt.scatter(x-axis, y-axis, s=None, c=None) : 주어진 x축, y축 데이터를 바탕으로 점을 그림\n<ul>\n<li>s : 점의 크기</li>\n<li>c : 색깔 지정 (리스트 형태로도 지정가능하며 리스트 길이만큼 cmap과 norm을 mapping하여 색을 표현)</li>\n<li>e.g. <code class=\"language-text\">plt.scatter(X, y, s=30, c=\"red\")</code></li>\n</ul>\n</li>\n<li>plt.show() : 플롯을 보여줌</li>\n<li>np.linspace(start, end, number_of_sample) : sampling을 위해 주로 사용되는 함수이며, start~end 구간 내에 있는 데이터들을 지정한 개수(number_of_sample) 만큼 균등하게 샘플링하여 array형태로 반환해줌\n<ul>\n<li>\n<p>end_point=False 로 설정한다면, 리스트의 인덱싱과 같이 start ~ (end-1) 구간으로 설정되며, 기본 값은 end_point=True</p>\n</li>\n<li>\n<p>e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.0</span><span class=\"token punctuation\">,</span> num<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> array([2.  , 2.25, 2.5 , 2.75, 3.  ])</span>\nnp<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.0</span><span class=\"token punctuation\">,</span> num<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> endpoint<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> array([2. ,  2.2,  2.4,  2.6,  2.8])</span></code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>위의 기본 사용법을 바탕으로 그래프를 그려보자!</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">foo <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">/</span><span class=\"token number\">7</span><span class=\"token operator\">*</span>x<span class=\"token operator\">**</span><span class=\"token number\">3</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>x<span class=\"token operator\">**</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">15</span><span class=\"token operator\">*</span>x<span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span>\n\nX <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\ny <span class=\"token operator\">=</span> foo<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span>\n\nx_sample <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\ny_sample <span class=\"token operator\">=</span> foo<span class=\"token punctuation\">(</span>x_sample<span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>scatter<span class=\"token punctuation\">(</span>x_sample<span class=\"token punctuation\">,</span> y_sample<span class=\"token punctuation\">,</span> c<span class=\"token operator\">=</span><span class=\"token string\">\"red\"</span><span class=\"token punctuation\">,</span> s<span class=\"token operator\">=</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>axhline<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token string\">'black'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>axvline<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token string\">'black'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>→ 출력되는 그래프</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 386px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjUlEQVQ4y42TiW7CMBBE8/9fWJW2oAIJNIfjOw5xphrTHBXQstLK99v1eJ0BwDiOqOsaSilYa2GM+ded92ikQtMqOGehtYb3HtkwDAm23+/TRIwRnPvLR4woD2eUwqBUHrX2GC6XBE3ApmlQFAX6vsczVpkArd08lq6HMB7eWWTMiMA8z2cgJbjntNYGSBd+7aPp4wlWqSuQV07AsGxc2uVQ1w+oVLesrYDjGJO2GbMSQiAvCoRVhnMGq/FZeQxxvBMUGOIPkK/ati2KwwF96G6uMrXiq4Gx3W3An36cgHwUZrh9eYWW6rox/taNVy0ryYWH2pKTgBxYo7HbH1MJPHrVZ4y3TUCpFD7e3/D2WaRCZQDWlLUGu6LCVy3SHAv/nnMvZaMnICc3mw3KqsY2r9C0ErIR2B1LnKoFxoP0NWhqpZRXIMXkgD/FWQvfBeTCIN8doZTB5dKj67pUoyGEuU9f951zVw0pKgUlnZGSuLyus4hxmLOYDvETTDDWL4PQp5+W4UnjoelF79m09g23IUPpHh2/RgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"plot\"\n        title=\"plot\"\n        src=\"/static/d5386f8377c68221eb5c2e545395ee50/7bc0b/plot.png\"\n        srcset=\"/static/d5386f8377c68221eb5c2e545395ee50/e9ff0/plot.png 180w,\n/static/d5386f8377c68221eb5c2e545395ee50/f21e7/plot.png 360w,\n/static/d5386f8377c68221eb5c2e545395ee50/7bc0b/plot.png 386w\"\n        sizes=\"(max-width: 386px) 100vw, 386px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"2-linear-regression\" style=\"position:relative;\"><a href=\"#2-linear-regression\" aria-label=\"2 linear regression permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Linear Regression</h2>\n<p>선형 회귀란, 한 개 이상의 독립 변수 X와 종속 변수 y 간의 선형 상관 관계를 모델링하는 회귀 분석 기법이다. (출처 : <a href=\"https://ko.wikipedia.org/wiki/%EC%84%A0%ED%98%95_%ED%9A%8C%EA%B7%80\">위키피디아</a>)</p>\n<p><a href=\"https://scikit-learn.org/stable/index.html\">Scikit-learn</a> 라이브러리로 쉽게 많은 <a href=\"https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html\">선형 회귀</a>와 같은 통계적인 모델 + 기계학습 모델들을 정의하고 사용할 수 있다.</p>\n<ul>\n<li>\n<p>Usage</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>linear_model <span class=\"token keyword\">import</span> LinearRegression\n\n<span class=\"token comment\"># 선형 회귀 모델 정의</span>\nlr <span class=\"token operator\">=</span> LinearRegression<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nfoo <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">/</span><span class=\"token number\">7</span><span class=\"token operator\">*</span>x<span class=\"token operator\">**</span><span class=\"token number\">3</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>x<span class=\"token operator\">**</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">15</span><span class=\"token operator\">*</span>x<span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span>\nx_sample <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\ny_sample <span class=\"token operator\">=</span> foo<span class=\"token punctuation\">(</span>x_sample<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 하나의 배치 당 하나의 feature를 가지도록 차원 추가</span>\nx_new <span class=\"token operator\">=</span> x_sample<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># 선형 회귀 모델에 fitting하여 학습</span>\nlr<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_new<span class=\"token punctuation\">,</span> y_sample<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Coefficient 계산</span>\nr2 <span class=\"token operator\">=</span> lr<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">(</span>x_new<span class=\"token punctuation\">,</span> y_sample<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># y값 예측</span>\ny_hat <span class=\"token operator\">=</span> lr<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>x_new<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 만약 하나의 데이터 포인트에 대한 예측값을 얻고 싶다면</span>\n<span class=\"token comment\"># y_hat = lr.predict(x_new[0, None])</span>\n\n<span class=\"token comment\"># Mean Squared Error 계산</span>\nMSE <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>y_hat <span class=\"token operator\">-</span> y_sample<span class=\"token punctuation\">)</span><span class=\"token operator\">**</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x_new<span class=\"token punctuation\">,</span> y_hat<span class=\"token punctuation\">)</span></code></pre></div>\n<p>→ 위의 plot에 더해서 그린 경우에 대한 그래프</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 393px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABuUlEQVQ4y41Ti26jMBDk/7+wzfXUlAQE5mH8wDYEPKddcJLSnFRLK2yzHs96ZzIAiDFCKQVrLcZx/FWEEKC0gbEW3jkYY3C73ZAty4JhGFCWJQOu68o//heUv8wz2msFoRwqaWGnhUG998goqes6CCH41t+MzngY4x7rrofRCvM8b4B936Oua74hPcGroCHHGTqsPF+dAqzAYiXk5xemadpKJoYEmBimw/x9AnNzRKcs4AdELQCvEeMGPoXA5x8MhYB/BkzMUl3LjLYqsZoGmEfe59gTQgKkjkkpIaoK4V4y7kAxWGBs0X/9hRvttrcnPT9F+MZQSuSnD4zabAfWdSuHyxrgfEDXmZ/sI34C0sIajc9LibqVwLQBRa8JmdkIHR6lH8ZLQBJoXeS4nj+weMtFJQAxOLjpxqxIo6+CBinkDiiHAe/vbzjnV5zymhtUVxVO5wJ5UaHvWjRNg7ZtOY5zUklRFOygjChTU/LLBVopaOtwaQZc/5whlWE5uN0Fx0j7xIzcxk5JVqMNuoEa4saRk7F7nOaUQ9bUWrP96DDJLc1Jx0Que/nQR3GTcKfp/l7HhrBr9n//ANtmQoR4xtlaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"plot+lr\"\n        title=\"plot+lr\"\n        src=\"/static/f2f4fe11edf396d16269d84ade5016b5/d72ec/plot%2Blr.png\"\n        srcset=\"/static/f2f4fe11edf396d16269d84ade5016b5/e9ff0/plot%2Blr.png 180w,\n/static/f2f4fe11edf396d16269d84ade5016b5/f21e7/plot%2Blr.png 360w,\n/static/f2f4fe11edf396d16269d84ade5016b5/d72ec/plot%2Blr.png 393w\"\n        sizes=\"(max-width: 393px) 100vw, 393px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n</ul>\n<h2 id=\"3-polynomial-regression\" style=\"position:relative;\"><a href=\"#3-polynomial-regression\" aria-label=\"3 polynomial regression permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Polynomial Regression</h2>\n<p>다항 회귀란, 2차 이상의 다항식으로 이루어진 독립 변수 X와 종속 변수 y 간의 상관 관계를 모델링하는 회귀 분석 기법이다. (출처 : <a href=\"https://en.wikipedia.org/wiki/Polynomial_regression\">위키피디아</a>)</p>\n<p>위의 선형 회귀 설명에서와 동일하게 <a href=\"https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html\">Scikit-learn</a>으로 구현되어 있어 쉽게 사용 가능하다.</p>\n<ul>\n<li>Usage</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>linear_model <span class=\"token keyword\">import</span> LinearRegression\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> PolynomialFeatures\n\nx_sample <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\nx_new <span class=\"token operator\">=</span> x_sample<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">]</span>\n\nfoo <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">/</span><span class=\"token number\">7</span><span class=\"token operator\">*</span>x<span class=\"token operator\">**</span><span class=\"token number\">3</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>x<span class=\"token operator\">**</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">15</span><span class=\"token operator\">*</span>x<span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span>\ny_sample <span class=\"token operator\">=</span> foo<span class=\"token punctuation\">(</span>x_sample<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 6차 다항식으로 변환</span>\npoly <span class=\"token operator\">=</span> PolynomialFeatures<span class=\"token punctuation\">(</span>degree<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\nx_sample_poly <span class=\"token operator\">=</span> poly<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>x_new<span class=\"token punctuation\">)</span>\npoly_lr <span class=\"token operator\">=</span> LinearRegression<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_sample_poly<span class=\"token punctuation\">,</span> y_sample<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># -> x_new 출력</span>\n<span class=\"token comment\"># Before transform: (Single features)</span>\n<span class=\"token comment\"># [[ 0. ]</span>\n<span class=\"token comment\">#  [ 2.5]</span>\n<span class=\"token comment\">#  [ 5. ]</span>\n<span class=\"token comment\">#  [ 7.5]</span>\n<span class=\"token comment\">#  [10. ]]</span>\n\n<span class=\"token comment\"># -> x_sample_poly 출력</span>\n<span class=\"token comment\"># After transform: (Multiple features)</span>\n<span class=\"token comment\"># [[1.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00</span>\n<span class=\"token comment\">#   0.00000000e+00 0.00000000e+00 0.00000000e+00]</span>\n<span class=\"token comment\">#  [1.00000000e+00 2.50000000e+00 6.25000000e+00 1.56250000e+01</span>\n<span class=\"token comment\">#   3.90625000e+01 9.76562500e+01 2.44140625e+02]</span>\n<span class=\"token comment\">#  [1.00000000e+00 5.00000000e+00 2.50000000e+01 1.25000000e+02</span>\n<span class=\"token comment\">#   6.25000000e+02 3.12500000e+03 1.56250000e+04]</span>\n<span class=\"token comment\">#  [1.00000000e+00 7.50000000e+00 5.62500000e+01 4.21875000e+02</span>\n<span class=\"token comment\">#   3.16406250e+03 2.37304688e+04 1.77978516e+05]</span>\n<span class=\"token comment\">#  [1.00000000e+00 1.00000000e+01 1.00000000e+02 1.00000000e+03</span>\n<span class=\"token comment\">#   1.00000000e+04 1.00000000e+05 1.00000000e+06]]</span></code></pre></div>\n<p>아래의 그림과 같이, 항의 차수가 커질 수록 sample들의 특징을 더 잘 반영하여 모델링이 가능하지만 너무 커지면 Overfitting 되는 문제가 있다. 반대로, 항의 차수가 너무 낮으면 Underfitting 되는 문제가 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABVUlEQVQoz1VSa2/DIAzM//+L7VQ1W7Y1hFAgvMzjJkPWaZb4wJ19Phum1iqMMRBC4H6/Y9skrLVorSGlBK01lmXB+8cH9l0hhAAOrnkqhevbGx7rCqUUcs6YiDJiIhBRB+b5HfM8I8aIRPmFW3vgcrlCSolcKqR2CDF17uvrG7fbDc45TMFHeDu6cqRE8N53d/tuQSl3vJbam8QQwCaus0Cg2rnMppiLERO709qi0J/oEB4JyR1AK2gn3mpFSIRlVaDgBtYGmzNhYielNhz2gDa+E8EFmKdFLuyu4dD21WiXGocLUC7COQ9jjo57TxCbwsQ7qHVY34TFJgyWzyecD30/IzlhfWgIoSGlRaSM7WwuhMG6ajweGvLp/guyc0oVubQ+7q/gWEFFogr+FTyyPAU5rCOUeo7MRTw2vybvjUE677+HeT6cy41KKfD9cWjcM/U6zvkByaRt+3hEHzAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"polylr_overfitting_underfitting\"\n        title=\"polylr_overfitting_underfitting\"\n        src=\"/static/59d231225ad496ffba22f5b27299346c/37523/polylr_overfitting_underfitting.png\"\n        srcset=\"/static/59d231225ad496ffba22f5b27299346c/e9ff0/polylr_overfitting_underfitting.png 180w,\n/static/59d231225ad496ffba22f5b27299346c/f21e7/polylr_overfitting_underfitting.png 360w,\n/static/59d231225ad496ffba22f5b27299346c/37523/polylr_overfitting_underfitting.png 720w,\n/static/59d231225ad496ffba22f5b27299346c/302a4/polylr_overfitting_underfitting.png 1080w,\n/static/59d231225ad496ffba22f5b27299346c/67a79/polylr_overfitting_underfitting.png 1408w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Overfitting이란, training error는 적고 variance(예측값들의 흩어진 정도)가 큰 반면, test error가 큰 현상이 나타는 문제를 말한다. 즉, training data에 대해서는 좋은 성능을 보일 수는 있어도 학습하지 않은 test data에 대해서는 좋은 성능을 보이지 못한다는 문제점을 가지고 있다.</p>\n<p>→ Overfitting 문제에 대한 대표적인 해결책으로는 더 많은 데이터를 사용하거나 Regularization(정규화)를 하는 방법이 있다.</p>\n<p>Underfitting은 Overfitting과는 반대로 training error와 test error가 둘 다 크며, bias(예측값과 정답값과의 차이) 또한 큰 현상이 나타는 문제를 말한다. 이는 충분히 학습되지 않아 나타는 현상이다.</p>\n<p>→ Underfitting 문제에 대한 해결하기 위한 대표적인 방법으로는 더 많은 feature를 추가하거나 항의 차수를 증가하여 모델의 complexity를 높이거나 더 오래 학습하는 방법이 해결책이 될 수 있다.</p>\n<h3 id=\"regularization-정규화\" style=\"position:relative;\"><a href=\"#regularization-%EC%A0%95%EA%B7%9C%ED%99%94\" aria-label=\"regularization 정규화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Regularization (정규화)</h3>\n<p>Overfitting 문제를 완화하기 위한 방법 중 Regularization(정규화) 방법은 모델의 자유도를 제한하여 hypothesis space를 줄인다. 즉, 모델의 가중치들을 제한시켜 variance를 줄이고, 일반화하는 능력을 높인다. 대표적인 정규화 방식에는 1) Ridge Regression 2) Lasso Regression 3) Elastic Net 세 가지가 있다.</p>\n<p>각 방식에 대해 하나씩 알아보자 !</p>\n<h4 id=\"ridge-regression\" style=\"position:relative;\"><a href=\"#ridge-regression\" aria-label=\"ridge regression permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>Ridge Regression</strong></h4>\n<p>Ridge Regression (릿지 회귀) 방법은 L2 Regression으로 불리며, 학습 시 Cost function (비용 함수)에 Loss의 가중치 값들에 대한 L2 regularization term을 더하여 모델의 자유도를 제한한다.</p>\n<p>예를 들어, 6차원의 다항식에 대해 다항회귀를 할 때</p>\n<p>$w^Tx+b = w_6x^6+w_5x^5+…+w_1x^1+ b$</p>\n<p>릿지 회귀 방법에서의 비용 함수는 아래와 같이 표현된다.</p>\n<p>$$\nL(y,y’)+\\frac{\\alpha}{2}\\lVert w\\rVert^2\n$$</p>\n<p>여기에서 $\\alpha$ 는 제한의 정도(penalty) 지정하는 hyperparameter이다. $\\alpha$ 가 0이면 linear regression 이고, $\\alpha$ 값이 커질 경우 모든 가중치들이 0과 가깝게 되어 예측 값이 데이터들의 평균에 가깝게 flat 한 형태가 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 258px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 98.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADEElEQVQ4y3WUXXOySBCF+f9/Z++2dq9ytzfWmxgTX0VQQBAYvgdQgWerJ6ImtdtVUyM2fTh9+sNarVbs93viOEaphDSNSdOUPM/Jsszc4kuS5H6L/+c5RSf6rscahoGyLEnTHJVdybILVVWz2+04HA5st1sul8v99H3POI5I3HzE8jKnqAqszWaD5x1omo5zD5ceuq7ndDqhlCIMQxMggefz+Q4w2zRN5g7VET/1sa7XK1VZoQpF1EYkXYJuNa7jcjwe+fj4IIoiPM/j5eWFruvuQPMR89KAMIuwJCXXddF1zaQbplYbJsKwKAqjmbCSNAVM0n4wewA6/pJapTcNq4qqKKBpmBpNXdVGuyAIiOPEBAigBEtGD4bGwzjB338u0GWBJex836e9pVI1E00z3oLmwEcBBPimHuP4xa7Iev76Y0V/7rEkBanyrE1VTXcgCRJCVfWtDvT9RNtOhp2YCgMWrzZVecGybRvX3RvdBEMqPWsjR1hcr9ON0TiTI4khK4C6Y7f7xAtL4rj90rCqKrquJc8gOF6+sREICTxfb+yGASdS2L7P79WexT8f7EJp7J4wbLBkSjz/gG4H/KRlEwdsAg+lYnQ2kIVX2nwgcUqOrsv6/YPfqwOxE9M1KRu3o23hdNIEgRYNr7RNye7VY7l8ZYgV9psiCRze3lZ4W5c8d9h6Np/blDQauXaPDOqbvnGsiSKN5bgup6PPr5VDomrqbCLwIVUQqxGlNd3Y0fXQ1FBWfGtsI6hUutDkucYSoYuiZOXZxiGBwzDRtaMp0Ln7NmimSM9gc2NrrWkajWVvbZyDy2Lt3oPERJevHp7biP+0GbBttQG15OHd3rN4P90mYm7Y8el5vLXQeAeYf8/PTdPQti3WdrNh8WvF3vOp68osBNlvMseyFLJMmZ0oW0fueQOJX96T39J2Eid+Sxp6vf5Epan5kixceUG+LPMsX5Ud6DiOWQzCZL1emzEUUNvemTgBl/+tWbXxRv15Lc2TIaO5XC4N4HOa4n+WQ8x6fmH6H+Vlw0hqP3fhz8LI/S+3WwKpJx3/kAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ridge_alpha\"\n        title=\"ridge_alpha\"\n        src=\"/static/74ef7346347b33037b78cec714fd50c1/d9489/ridge_alpha.png\"\n        srcset=\"/static/74ef7346347b33037b78cec714fd50c1/e9ff0/ridge_alpha.png 180w,\n/static/74ef7346347b33037b78cec714fd50c1/d9489/ridge_alpha.png 258w\"\n        sizes=\"(max-width: 258px) 100vw, 258px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Scikit-learn 구현은\n아래와 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>linear_model <span class=\"token keyword\">import</span> Ridge\nridge_reg <span class=\"token operator\">=</span> Ridge<span class=\"token punctuation\">(</span>alpha<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span>\nridge_reg<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\nridge_reg<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"lasso-regression\" style=\"position:relative;\"><a href=\"#lasso-regression\" aria-label=\"lasso regression permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>Lasso Regression</strong></h4>\n<p>Lasso (<strong>L</strong>east <strong>A</strong>bsolute <strong>S</strong>hrinkage and <strong>S</strong>election <strong>O</strong>perator) Regression 는 위의 Ridge regression 에서 사용한 L2 regularization 대신, L1 regularization을 하는 방법이다.</p>\n<p>위에 설명한 6차원의 다항식을 토대로, 라쏘 회귀에서의 비용 함수는 다음과 같다.</p>\n<p>$$\nL(y,y’)+\\alpha(|w_6|+|w_5|+…+|w_1|)\n$$</p>\n<p>라쏘 회귀의 큰 특징 중 하나는 중요하지 않은 feature들의 가중치를 제거하는 경향이 있다는 것이다.</p>\n<ul>\n<li>Why? 역전파(Backpropagation) 시에 비용 함수에 대해 편미분하게 되면, 가중치는 상수 값이 되어버리기 때문에, 가중치가 너무 작은 경우 0에 가까워 중요하지 않은 feature들의 가중치들의 제거하는 효과를 나타내게 된다.</li>\n</ul>\n<p>위의 릿지 회귀의 그래프 이미지와 유사하면서도, 가중치를 더 작게 설정하더라도 더 flat하게 만드는 경향이 나타난다. 즉, 자동적으로 feature selection하는 효과를 나타내고 sparse model을 도출해낸다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 260px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC+0lEQVQ4y6WU7XKzNhCFuf+b6e/eQpvJvGk89UcSGzDf5huEwBiezgrj5G3e/urO7CAk7dGuVudY+/0ex3HI85w8z4xnWUZRFJRlaVz+V1/2ffc0TRmGAavvezNxuaSUlSYvFE3TkqYXoijifD6jlDLetq35SqDErT6Oo8GQdcv3fTzvTF0rVAtNDcNw43g8ImsC+NWmaeJXprVGdxqraZol7SrnoiKSNqQfNK7rmnLf39/xPI8kSXh6ejIZis3z/HCxoiqpmxorCAJs26auayZmxunG9ToShiFVVRlgOVRKi+PYlLsCwsw0LxlHpUeQBVhyYpbnNEUBdQ15wTj0HA4HwiAwIF9N7usBOPPI8I/NB1VTLhlKSdKIeZ7QeqSqRsbxajK9Xq9M02iAZDyOtzv0zDQtYI268dvvR5TSWHKZcodd15nFspzR+jMjSUAS/7kxM0tiS7mZqnjZOxT5gCVdPJ1OD8DrMDNPnxcuwb02tT3mx3HC9yeaSsBvbD2X06khyzosKaUoSvTQ02qI0+9P4l7Zw4Yr1A144cyfB4e4HIgTcYWVXC6cHQflBxRvJc25oXVjmjigsF3Co8/xh83x7zO5c+L84XD4seO4cwntDYe/HJRbE+48oqDBquqassy4BIoobEkql+eNQ5iGHE4+O9ulaHy8xGf/EfFuZ1yShqHX0nLaYmYabsR+RRwrrDhO8Hyb573L1j+TlpqTDXkOZQFDfy+zX1hUll8aZny5jyxXFEUn77AjuoTs7WhpSg99P9O2M6oTn5ikOfcGaX2H+RdT5Nm1rcISpfE8H98b7g2YTIAE/jr45/+V2yIMXacWtUnTkt1O839M3rM8Pct1HfZ7G8fJzAnyhITDwl8RB+G4jEUf5bvOy1fWhBRCXxEPI1+CutlscJyTIf7r66uRLMl8t9sZTZSNMl4F9/n52cwJyMvLi6Gl0He73WKthL/dbg/yrxe9CoGAv729Pe5LOL1q4xonY6PYa/CnJH0fy0bRRf2F5P+19x+X9QMSLlAyFAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"lasso_alpha\"\n        title=\"lasso_alpha\"\n        src=\"/static/d02bf624951dbabc30c9963854595415/86c28/lasso_alpha.png\"\n        srcset=\"/static/d02bf624951dbabc30c9963854595415/e9ff0/lasso_alpha.png 180w,\n/static/d02bf624951dbabc30c9963854595415/86c28/lasso_alpha.png 260w\"\n        sizes=\"(max-width: 260px) 100vw, 260px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Scikit-learn으로 쉽게 사용 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>linear_model <span class=\"token keyword\">import</span> Lasso\nlasso_reg <span class=\"token operator\">=</span> Lasso<span class=\"token punctuation\">(</span>alpha<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span>\nlasso_reg<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\nlasso_reg<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h4 id=\"elastic-net\" style=\"position:relative;\"><a href=\"#elastic-net\" aria-label=\"elastic net permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>Elastic Net</strong></h4>\n<p>Elastic Net은 Ridge Regression 과 Lasso Regression의 중간으로, 두 regularization term을 섞어 사용한다. mix ratio r 으로 조절할 수 있다.</p>\n<p>$$\nL(y,y’)+r\\alpha(\\sum_{i=1}^n|w_i|)+\\frac{l-r}{2}\\alpha\\lVert w\\rVert^2\n$$</p>\n<p>세 가지 정규화 방법 중에 보통 Ridge를 기본으로 많이 사용되지만, 일부 적은 feature만 유용할 때 Lasso 나 Elastic Net을 사용한다. 보통 Lasso의 경우 feature의 개수가 training instance보다 많거나 일부 feature들이 correlate될 때 예측이 어려우므로, Lasso 보다 Elastic Net이 선호된다.</p>\n<p>Scikit-learn으로 쉽게 사용 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>linear_model <span class=\"token keyword\">import</span> ElasticNet\nelastic_net <span class=\"token operator\">=</span> ElasticNet<span class=\"token punctuation\">(</span>alpha<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> l1_ratio<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\nelastic_net<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span>\nelastic_net<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1.5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"다항-회귀-vs-릿지-회귀\" style=\"position:relative;\"><a href=\"#%EB%8B%A4%ED%95%AD-%ED%9A%8C%EA%B7%80-vs-%EB%A6%BF%EC%A7%80-%ED%9A%8C%EA%B7%80\" aria-label=\"다항 회귀 vs 릿지 회귀 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>다항 회귀 vs 릿지 회귀</h3>\n<p>다항 회귀에 대해 릿지 정규화의 적용한 릿지 회귀 또한 <a href=\"https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html\">scikit-learn</a> 라이브러리로 쉽게 적용 가능하다.</p>\n<ul>\n<li>\n<p>Implementation</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>linear_model <span class=\"token keyword\">import</span> LinearRegression\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> PolynomialFeatures\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>linear_model <span class=\"token keyword\">import</span> Ridge\n\nx_line <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\nx_sample <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\nx_new <span class=\"token operator\">=</span> x_sample<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">]</span>\n\nfoo <span class=\"token operator\">=</span> <span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">/</span><span class=\"token number\">7</span><span class=\"token operator\">*</span>x<span class=\"token operator\">**</span><span class=\"token number\">3</span><span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token operator\">*</span>x<span class=\"token operator\">**</span><span class=\"token number\">2</span><span class=\"token operator\">+</span><span class=\"token number\">15</span><span class=\"token operator\">*</span>x<span class=\"token operator\">-</span><span class=\"token number\">10</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span>\nY <span class=\"token operator\">=</span> foo<span class=\"token punctuation\">(</span>x_line<span class=\"token punctuation\">)</span>\ny_sample <span class=\"token operator\">=</span> foo<span class=\"token punctuation\">(</span>x_sample<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 6차 다항식으로 변환</span>\npoly <span class=\"token operator\">=</span> PolynomialFeatures<span class=\"token punctuation\">(</span>degree<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\nx_sample_poly <span class=\"token operator\">=</span> poly<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>x_new<span class=\"token punctuation\">)</span>\nx_line_poly <span class=\"token operator\">=</span> poly<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>x_line<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 다항 회귀 적용 및 예측</span>\npoly_lr <span class=\"token operator\">=</span> LinearRegression<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_sample_poly<span class=\"token punctuation\">,</span> y_sample<span class=\"token punctuation\">)</span>\ny_poly <span class=\"token operator\">=</span> poly_lr<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>x_line_poly<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># Ridge 회귀 적용 및 예측</span>\n<span class=\"token comment\"># penalty의 정도를 나타내는 lambda는 'alpha'라는 hyperparameter로 사용됨 !</span>\nrr <span class=\"token operator\">=</span> Ridge<span class=\"token punctuation\">(</span>alpha<span class=\"token operator\">=</span><span class=\"token number\">10.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_sample_poly<span class=\"token punctuation\">,</span> y_sample<span class=\"token punctuation\">)</span>\ny_poly_rr <span class=\"token operator\">=</span> rr<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>x_line_poly<span class=\"token punctuation\">)</span></code></pre></div>\n<p>→ Plot으로 표현</p>\n<p>(blue: 정답 값, orange: 다항 회귀 예측 값, green: 릿지 회귀 값)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 382px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7klEQVQ4y3WT6XLbIBRG/f4v1v7qTJNJEzeL5MiOVgRIQmiD00GO7GSSMvMNl+3wcYGd9566rimKgrIsMcbQti1d132jltYYOlVjtaAzlkKodX5vDFUl2AFIKcmyDCFEaOKc+17e46eBSR85vPwiSiIa68ikYV48WusrMLhTSq3A4PprOff5NiUSR0rdI4s9dulxDspmREvJLizegKHegB9FqFfrE2/pAyfVnffoFbl8XceaOqWIn64OQw7VByAb8INjo07sT/HV72SZu5Lc1gixR8mK3bIsV4daXx1eQH7NXSjPh1vaYXifE+SgLZm8Y+kKWlmzs9auySzzHF3k50vx7uJqq7XIyNPHc19I2jbeCZgnGDQ6ANcjK8XxNeHh9w+crS4g93505+H+8MAyj59zHOJ5xMsE+hrddmdgcBmezP0pR8iYtn37dL8v+Rt1FfHfMjTgF9ruHWhMzyGO+fv4QpwpkviGOLkjFQU3UcTt3U90lSNquX6CL5IKqTRJkmxAw/F4oioLVGdJa0MZ37N/+kOaRSy6YJhmhmFgHMdVn2PLPE9UVXUGhm8Vnk2QW2a0sZRlzVhlLI2g7/vL4hBvsBCHdG0brMDtFsNgeD7zPK87No1mWhy9HdZjbYtCrgMkzAv9TdOs3zL0B/0DNoLsDadgweQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"plot_poly_ridge\"\n        title=\"plot_poly_ridge\"\n        src=\"/static/88356318acf8825ffe3c2fa283de5091/77edc/plot_poly_ridge.png\"\n        srcset=\"/static/88356318acf8825ffe3c2fa283de5091/e9ff0/plot_poly_ridge.png 180w,\n/static/88356318acf8825ffe3c2fa283de5091/f21e7/plot_poly_ridge.png 360w,\n/static/88356318acf8825ffe3c2fa283de5091/77edc/plot_poly_ridge.png 382w\"\n        sizes=\"(max-width: 382px) 100vw, 382px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</li>\n</ul>\n<h2 id=\"4-classification-logistic-regression-support-vector-machine-decision-tree\" style=\"position:relative;\"><a href=\"#4-classification-logistic-regression-support-vector-machine-decision-tree\" aria-label=\"4 classification logistic regression support vector machine decision tree permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Classification (Logistic Regression, Support Vector Machine, Decision Tree)</h2>\n<p>대표적인 Classification(분류) 모델으로는 다음과 같이 세 가지가 있다.</p>\n<ul>\n<li>Logistic Regression (로지스틱 회귀)</li>\n<li>Support Vector Machine (SVM) (서포트 벡터 머신)</li>\n<li>Decision Tree (결정 트리)</li>\n</ul>\n<h3 id=\"logistic-regression-로지스틱-회귀\" style=\"position:relative;\"><a href=\"#logistic-regression-%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1-%ED%9A%8C%EA%B7%80\" aria-label=\"logistic regression 로지스틱 회귀 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Logistic Regression (로지스틱 회귀)</h3>\n<p>로지스틱 회귀는 선형 회귀와 같이 입력 feature들의 weighted sum을 계산하지만, 결과를 바로 출력하는 것이 아니라 결과의 logistic을 출력한다. logistic 은 sigmoid function을 뜻하며 0과 1 사이의 값을 가진다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 649px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLElEQVQoz3VSi26DMBDj/7+x0kRpIRDyggQSoPHk0E7axE6yTjnuLrZDlXPGXzBerxe01vDeY993WGsLtm0DW67miAr/BBfO84x1XTFNE+q6RtPcEcL07siXc1WMEX0/QCkHpTT6XsAYU9g45zBNDlKO0FrBGIe2tWhbg8djQtP4gvvd4/mccRwHKu9nSKngHKC1Q9e1GIYBXdeVBkZKK6xdoTXgfUYIGfv+26IYU7GmoqxxHJFSLKBHZP1BzjvG8WTBb8fBwYRtS0jpBOshhHMh/bHWXfrBy0MAhDgHP7WrOC97S65rCSH2MijEhsfD4+tL43Yb0TSq+CpEV15dSgml1E+mOmbaVBjSA2N0kcBfhJk2UP66LohxwbIs5aXJgj1kwjMXUCrrPNOib3WZa9zWJ9EZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sigmoid\"\n        title=\"sigmoid\"\n        src=\"/static/9470a6fb48d26a197d33e2c82ef4f88f/7762d/sigmoid.png\"\n        srcset=\"/static/9470a6fb48d26a197d33e2c82ef4f88f/e9ff0/sigmoid.png 180w,\n/static/9470a6fb48d26a197d33e2c82ef4f88f/f21e7/sigmoid.png 360w,\n/static/9470a6fb48d26a197d33e2c82ef4f88f/7762d/sigmoid.png 649w\"\n        sizes=\"(max-width: 649px) 100vw, 649px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>logit (log-odds) : logistic function의 역으로, positive class인지 negative class인지 측정된 확률(p)의 ratio의 log 값이다.</p>\n<p>$logit(p) = log(p/(1-p))$</p>\n</li>\n</ul>\n<p>closed-form equation이 아니기 때문에, 비용함수를 최소화 하는 parameter를 계산하는 것이 어렵지만, 비용함수가 convex 형태일 경우 Gradient Descent와 같은 최적화 알고리즘을 사용한다면 global optimum을 찾을 수 있다.</p>\n<ul>\n<li>multiple classes의 경우, softmax regression(multinomial logistic regression)으로 사용할 수 있다. 이 때, 클래스와 클래스 별 확률을 match하여 측정하는 cross entropy 비용 함수를 사용한다.</li>\n</ul>\n<h3 id=\"support-vector-machine-svm-서포트-벡터-머신\" style=\"position:relative;\"><a href=\"#support-vector-machine-svm-%EC%84%9C%ED%8F%AC%ED%8A%B8-%EB%B2%A1%ED%84%B0-%EB%A8%B8%EC%8B%A0\" aria-label=\"support vector machine svm 서포트 벡터 머신 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Support Vector Machine (SVM) (서포트 벡터 머신)</h3>\n<p>서포트 벡터 머신 분류는 쉽게 설명하자면, 분류하고자 하는 두 클래스 간의 거리(margin)를 최대화하는 모델이다. small or medium 크기의 데이터 셋에 적합한 모델이다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 350px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 83.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACm0lEQVQ4y3WUXW/bNhSG8/9/xG52110M2OWKoe1WtEld1Hb8FcCOHVmW9WHZkmVJJEVRzyD6o3GSEqBEHlAP3nNe8dwAZFmG53kkSdJuaZrGvo1pMKc1NKf4cV/X9eXc829u2keapvR6PSaTyQlknoGgNi3sCJUKyhJMYxBCcDgcUEpdoDc/1RjieHtR047OpGbwaM76kBKCUFIKDxCkacZisbiouwKWpSDfR9yO4OMPbWPbfcP7bzXvO8f9JlbkuQPMEbNbjMjQdUOlqp8pnxdSSuI4olQQp4ZSNvixYboyJBlEkaQsl4CDmH5Fb+4BF61zZCXfUCgkh33Ef334OtD8873mblzTnxm6wy27xLEwufyO3gyAFUo9cShiKvNGDc8Ks6JN1fDHh8rGlRL89uc9db1Aze+ogt4RJp+I9x7aVNcuvwSmOewyw8wDrTVl6VhAnYxRfhfwLCzLt9SNbkm/MEVI8izi707DowczJ+X3v45qZPKAjts01+hqSXIIKar9q3/wlcIwDE/hiiBaECZzyB9QUb/1mNvhO7rTzzQY+uuPePsZA//fC/RVDTebmNoY66ZhTrq6Q8dD62ZrwD7b4iZTJtEtQheoWlBU2dvAqqrs9avUClii0wnFumthQszBwCIZ4qYP9nzP+8Cu8K9SvgIeDhlL5wfgY7IHzHZka1Zrl1LuGYaf7bn5rs8yHdv1ffCJXCdvu5zna5buF4LZF9bjT4SbLo7TwXWf8IOAwWOHIAjxA5+1vybwA4LQZzQakef5tcJ2CllSbKfIsEuDQ57PyPPMdpy61vZ6tx3mPNu7L0rBeDS2zeUCbBdJssN1V+iqsm4qtUDJkuvR8HK0gLb2V93m3NuKojh1HW1vx3PnfjVfwtsa/g/2iB1M6ZQr4AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"svm\"\n        title=\"svm\"\n        src=\"/static/bd4709a7228e72b93094a86547fadd91/13ae7/svm.png\"\n        srcset=\"/static/bd4709a7228e72b93094a86547fadd91/e9ff0/svm.png 180w,\n/static/bd4709a7228e72b93094a86547fadd91/13ae7/svm.png 350w\"\n        sizes=\"(max-width: 350px) 100vw, 350px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>두 카테고리 중 어느 하나에 속한 데이터의 집합이 주어졌을때, 주어진 데이터 집합을 바탕으로 새로운 데이터가 어느 카테고리에 속할지 판단하는 비확률적 이진 선형 분류 모델을 만든다. 이 때, 데이터가 임베딩된 공간에서 경계(boundary)를 표현할 때 가장 큰 폭(large margin)을 가진 경계를 찾는다. 즉, 가장 가까운 각 클래스의 데이터 점들 간의 거리를 최대로 한다.</p>\n<p>때문에, 학습이 진행되는 동안 SVM은 각 훈련 데이터 포인트가 두 클래스 사이의 결정 경계를 구분하는 데 얼마나 중요한 지를 배우게 된다. 데이터셋 전체가 아닌 클래스 사이의 경계에 위치한 데이터 포인트들이 결정 경계를 만드는 데 영향을 준다. 이러한 데이터 포인트들을 서포트 벡터(support vector)라고 한다.</p>\n<p>선형 분류 뿐만 아니라 비선형 분류에서도 사용될 수 있으며, 선형적으로 분류가 어려운 데이터에 Feature를 더해(polynomial feature) 고차원 공간으로 대응시켜 분리를 쉽게 하는 방법을 사용한다. polynomial degree가 클 수록 모델이 느려지기 때문에, 문제에 적절한 kernel trick을 사용한다. 이는 점들의 집합과 상수 벡터의 내적 연산으로 정의하여 효율적으로 계산하도록 돕는다. 큰 데이터셋의 경우, Gaussian RBF Kernel을 사용한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 663px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC70lEQVQ4y4WTW1MaCRCF/c27z3nbh01lt7KulmuSMjEYFBgEVESMl6BynQsq6DDD3ACzgCiC68xYpSvflqhV+5auOtXVL6dPd5+eABheD+m2+5xZ15xZV3y3rjiz+uP8t92nbff5bl7Sti7oPML+H6wena5Nt9/g/v6eidFoBIywTi/Z+tIiE3Y4CNsUl3X2gwbb8zrFkIayrCJFVIohlVL4GUs64mqekraIpCXwfZeJR4U37jXaYYus0KAUN8iFDPYXNT6/bpJ8b5KYcQhP2mSX6hyt1JCWNeSYhhKtUVZSyJZAWU/i33pPhI8KHfWcQthAT6vEphymXp3x288dFt7YfH5t8etPHVZmbGLTNuW4hhw1UFbLiKcRFGuZQ+OZ8O7unsH1AKvSIBfUWXtnkphuIK0oqPIWqb0F1r9G2FuqEn7bIDplIUZriEIdaU1m7yiAWBcQa4knwmaziee7dIxz9gM6H35pkZx2kMUkSivC+tEscjOEfrpOfNJG+NMh9NZBjphU0wo7J3N8rXwkqwr4/vPIg+EVxlGD9HsTYcpiY9aikE+h2FG2DufJnARJH8+SjYvsfrT59sliK3DIt0KQzcocO9V5KubGWNjE45FHjGiqHcSQzk7ARArbHO7uUXaibFfmiUqTZNQA+9UgyXSSYj7FphggLP3O5vEc++oCRS3O7a3PxMPDA8PrAUblDFHQKEVrSBEDKZ1DMiOU6wmE0iSZ6hcS8gzrlb9YO5ohXPqDVPkDOTWEaEQpmKtPO3z04b8Pdzhqj1KoTjmmo0QMlGIKxYlQNuNktSB76gK7J/PkaktsVz6RrS2Sq4fI2wK5lkC+9UL4MML1btCOGxRjKsXYCfJGicJxFElbpVCNoehryLUVZH2NYi1BUV8hpyfIm6scGAkyTpyDRgr3xdi+79Nud/A8n16vx437D+e9czzPo9vtjHO73cbzPS4uL3A9l6vB1bju9/vcuDcMhgNc1315vR9Hq9UaN/5R/AegSoRtJTyHKAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"svm_kernel\"\n        title=\"svm_kernel\"\n        src=\"/static/1a1776bd6d1c8b30326a9e68e3a9f711/0786c/svm_kernel.png\"\n        srcset=\"/static/1a1776bd6d1c8b30326a9e68e3a9f711/e9ff0/svm_kernel.png 180w,\n/static/1a1776bd6d1c8b30326a9e68e3a9f711/f21e7/svm_kernel.png 360w,\n/static/1a1776bd6d1c8b30326a9e68e3a9f711/0786c/svm_kernel.png 663w\"\n        sizes=\"(max-width: 663px) 100vw, 663px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>장점 : 분류, 예측에 사용 가능. overfitting 정도가 덜하다. 예측의 정확도가 높고, 사용하기 쉬움</p>\n<p>단점 : kernel, parameter 조절 테스트를 여러번 해야 최적화된 모델을 만들 수 있음, 모델 구축 시간 오래걸림</p>\n<h3 id=\"decision-tree-결정-트리\" style=\"position:relative;\"><a href=\"#decision-tree-%EA%B2%B0%EC%A0%95-%ED%8A%B8%EB%A6%AC\" aria-label=\"decision tree 결정 트리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Decision Tree (결정 트리)</h3>\n<p>결정 트리 알고리즘은 Feature에 대해 아래의 그림과 같이 트리 자료 구조 기반으로 분류한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 494px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZ0lEQVQ4y52TC4+CQAyE/f8/jigxvkBRURFf4FtU6OWbZM1djtyd16TZ3bKdnU5Lw8ysqqpvjqVpaovFwpIksfl8rpVYURRWl4c1fgIErNfrWRiG5vu+DQYDWy6Xdrvd/geYZZnleW673c6226325/PZHo/He4Auhh2PRzHc7/cqebVa2fP5fA+QBBxmw+FQ7C6Xi7XbbYGjYVmWfwPE1uu1wIIgsFarpThn9JxMJnqA5tTl1gJyeTabqURWmjAejwXGCktK/xWQMrDNZqMxoaOwvV6vinEmHsexzs5qAR0Yhm6wJBGWTtP7/f4C5DtdP51OX5rYcBuMcYCR8263q5LdmGCUCzs0bTabGq3PTMUQkZmv0WikAYYNr9NVGNDVw+Eg3VyM+57naZxwx1SAlEUHYQMQ7KIokvf7fQES406n09HDkGBGibEH9AWI2O6fhQVlEOOB6XSqGSSJO2hInDuuUU5PAD8AuTnmR/uETdAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"dt\"\n        title=\"dt\"\n        src=\"/static/2fb30b794a9bb7ebb4e66f5ee0116ee6/d72d4/dt.png\"\n        srcset=\"/static/2fb30b794a9bb7ebb4e66f5ee0116ee6/e9ff0/dt.png 180w,\n/static/2fb30b794a9bb7ebb4e66f5ee0116ee6/f21e7/dt.png 360w,\n/static/2fb30b794a9bb7ebb4e66f5ee0116ee6/d72d4/dt.png 494w\"\n        sizes=\"(max-width: 494px) 100vw, 494px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>결정 트리는 feature scaling이나 centering과 같은 데이터 전처리가 필요하지 않다.</p>\n<p>Scikit-Learn 라이브러리에서의 구현은 Classification and Regression Tree(CART) 알고리즘을 기반으로 학습한다.</p>\n<p>먼저, 학습 데이터에 대해 하나의 feature $k$ 와 그에 대한 threshold $t_k$ 를 기준으로 두 개의 subset으로 나눈다. 이 때, threshold는 잘 분리된(Purest) Subset이 되도록 $(k, t_k)$ 쌍을 찾아서 설정한다.</p>\n<p>$$\nJ(k,t_k)=\\frac{m_{left}}{m}G_{left}+\\frac{m_{right}}{m}G_{right}\n$$</p>\n<p>$G_{left/right}$ 는 left, right subset의 잘 분리되지 않음의 정도(impurity)를 뜻하고, $m_{left/right}$ 은 left, right 각 subset의 개수를 뜻한다.</p>\n<p>Regression 문제에 적용한다면, $G_{left/right}$  대신 $MSE_{left/right}$   loss를 사용한다.</p>\n<p>$$\nMSE_{node} = \\sum_{i \\in node}(\\hat y_{node} - y^{(i)})^2 \\ \\hat y_{node}= \\frac{1}{m_{node}}\\sum_{i \\in node}y^{(i)}\n$$</p>\n<p><strong>max_depth</strong> parameter로 두어, 위의 과정을 재귀적으로 반복하며 depth만큼의 트리를 구축한다.</p>\n<p>선형 모델과 달리 결정 트리 모델의 경우 학습 데이터에 대하 제한하는 정도가 적기 때문에, 학습 데이터에 트리 구조가 너무 adapt하게 학습 될 경우에 overfitting 문제가 발생할 수 있다. 파라미터가 없다기 보다 파라미터로 인한 제한이 학습 이전에 없는 모델을 nonparametric 모델이라고 부른다. 반대로 parametric 모델은 degree of freedom이 제한되기 때문에 overfitting의 위험을 줄일 수 있다. overfitting을 줄이기 위해서 freedom을 제한하기 위해 정규화(regularization)을 적용한다. 자세한 hyperparameter는 <a href=\"https://scikit-learn.org/stable/modules/tree.html#tips-on-practical-use\">여기</a>에 설명되어 있다.</p>\n<h3 id=\"implementation\" style=\"position:relative;\"><a href=\"#implementation\" aria-label=\"implementation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Implementation</h3>\n<p>위의 세 모델 (<a href=\"https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html\">Logistic Regression</a>, <a href=\"https://scikit-learn.org/stable/modules/svm.html#\">Support Vector Machine</a>, <a href=\"https://scikit-learn.org/stable/modules/tree.html#\">Decision Tree</a>) 모두 Scikit-learn 라이브러리로 간단하게 구현하여 사용할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>linear_model <span class=\"token keyword\">import</span> LogisticRegression\n\nlogistic <span class=\"token operator\">=</span> LogisticRegression<span class=\"token punctuation\">(</span>random_state<span class=\"token operator\">=</span><span class=\"token number\">1234</span><span class=\"token punctuation\">)</span>\nlogistic<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># softmax regression</span>\n<span class=\"token comment\"># softmax_reg = LogisticRegression(multi_class=\"multinomial\")</span>\n\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>svm <span class=\"token keyword\">import</span> SVC\n\nsvm <span class=\"token operator\">=</span> SVC<span class=\"token punctuation\">(</span>kernel<span class=\"token operator\">=</span><span class=\"token string\">'linear'</span><span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span><span class=\"token number\">1234</span><span class=\"token punctuation\">)</span>\nsvm<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>tree <span class=\"token keyword\">import</span> DecisionTreeClassifier\n<span class=\"token comment\"># more depth, increase decision boundary - leads to overfitting </span>\n<span class=\"token comment\"># similar to polynomial</span>\ndt <span class=\"token operator\">=</span> DecisionTreeClassifier<span class=\"token punctuation\">(</span>max_depth<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span><span class=\"token number\">1234</span><span class=\"token punctuation\">)</span> \ndt<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span></code></pre></div>\n<p>👉🏼 관련 실습 코드 :</p>\n<p><a href=\"https://github.com/Sunkyoung/PyTorch-Study/blob/main/PyTorch_Study_02_Basic_ML.ipynb\">https://github.com/Sunkyoung/PyTorch-Study/blob/main/PyTorch_Study_02_Basic_ML.ipynb</a></p>\n<p><strong>Reference</strong></p>\n<p>Aurelien Geron, Hands-on Machine Learning with Scikit-Learn, Keras, and TensorFlow, O’reilly (2019)</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#1-matplotlib\">1. Matplotlib</a></p>\n</li>\n<li>\n<p><a href=\"#2-linear-regression\">2. Linear Regression</a></p>\n</li>\n<li>\n<p><a href=\"#3-polynomial-regression\">3. Polynomial Regression</a></p>\n<ul>\n<li>\n<p><a href=\"#regularization-%EC%A0%95%EA%B7%9C%ED%99%94\">Regularization (정규화)</a></p>\n<ul>\n<li><a href=\"#ridge-regression\"><strong>Ridge Regression</strong></a></li>\n<li><a href=\"#lasso-regression\"><strong>Lasso Regression</strong></a></li>\n<li><a href=\"#elastic-net\"><strong>Elastic Net</strong></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%8B%A4%ED%95%AD-%ED%9A%8C%EA%B7%80-vs-%EB%A6%BF%EC%A7%80-%ED%9A%8C%EA%B7%80\">다항 회귀 vs 릿지 회귀</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#4-classification-logistic-regression-support-vector-machine-decision-tree\">4. Classification (Logistic Regression, Support Vector Machine, Decision Tree)</a></p>\n<ul>\n<li><a href=\"#logistic-regression-%EB%A1%9C%EC%A7%80%EC%8A%A4%ED%8B%B1-%ED%9A%8C%EA%B7%80\">Logistic Regression (로지스틱 회귀)</a></li>\n<li><a href=\"#support-vector-machine-svm-%EC%84%9C%ED%8F%AC%ED%8A%B8-%EB%B2%A1%ED%84%B0-%EB%A8%B8%EC%8B%A0\">Support Vector Machine (SVM) (서포트 벡터 머신)</a></li>\n<li><a href=\"#decision-tree-%EA%B2%B0%EC%A0%95-%ED%8A%B8%EB%A6%AC\">Decision Tree (결정 트리)</a></li>\n<li><a href=\"#implementation\">Implementation</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"1. Matplotlib NumPy 라이브러리를 활용하여 그래프를 만들어 시각화할 수 있는 라이브러리이다. 지난번 NumPy에 대한 기본적인 설명은 여기에! 👇🏼 https://sunkyoung.github.io/pytorch-study-01/ How to use ? Basic usage plt.plot(x-axis, y-axis) : 주어진 x축, y축 데이터를 바탕으로 선형 그래프를 그림 plt.scatter(x-axis, y-axis, s=None, c=None) : 주어진 x축, y축 데이터를 바탕으로 점을 그림 s : 점의 크기 c : 색깔 지정 (리스트 형태로도 지정가능하며 리스트 길이만큼 cmap과 norm을 mapping하여 색을 표현) e.g.  plt.show() : 플롯을 보여줌 np.linspace(start, end, number_of_sample) : sampling을 위해 주로 사용되는 함수이며, start~end 구간 내에 있는 데이터들을 지정한 개수(n…","frontmatter":{"date":"March 31, 2022","title":"Review AI504 Practice Session - 02 Basic ML","categories":"Deeplearning","author":"선경","emoji":"🔥"},"fields":{"slug":"/pytorch-study-02/"}},"next":{"id":"b76a24f9-7b50-5b9b-959d-12d843bfdcce","html":"<h2 id=\"0-numpy\" style=\"position:relative;\"><a href=\"#0-numpy\" aria-label=\"0 numpy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. NumPy</h2>\n<p>행렬이나 일반적으로 대규모 다차원 배열을 쉽게 처리 할 수 있도록 지원하는 파이썬의 라이브러리이다. (출처: <a href=\"https://ko.wikipedia.org/wiki/NumPy\">위키피디아</a>)</p>\n<ul>\n<li>How to use? <code class=\"language-text\">import numpy as np</code></li>\n</ul>\n<h2 id=\"1-numpy-array-data\" style=\"position:relative;\"><a href=\"#1-numpy-array-data\" aria-label=\"1 numpy array data permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. NumPy array data</h2>\n<ul>\n<li>Scalar : single number\n<ul>\n<li>e.g. <code class=\"language-text\">a = np.array(1.)</code></li>\n</ul>\n</li>\n<li>Vectors : an array of numbers\n<ul>\n<li>e.g. <code class=\"language-text\">b = np.array([1., 2., 3.])</code></li>\n</ul>\n</li>\n<li>Matrix : 2-D array\n<ul>\n<li>e.g. <code class=\"language-text\">c = np.array([[1., 2., 3.], [4., 5., 6.]])</code></li>\n</ul>\n</li>\n<li>Tensor : N-dimensional array (n ≥ 2)\n<ul>\n<li>e.g. <code class=\"language-text\">d = np.array([[[1., 2., 3.], [4., 5., 6.]], [[7., 8., 9.], [10., 11., 12.]]])</code></li>\n</ul>\n</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAACI0lEQVQozz2O30tTARzFv23O2c8R4YPztjSlJrlpzTAis6xUEimhVktzzt177mai7ofXbfe6Xe/u3HA2N01rUYZI1IOEEEHgm/RS+Sa9VvQQ9B/0YCwm0YHP0+FzOARAB+AEgGoARgAGAMf/cRSAFkAjgBoAVR6PZ5/f56N+54Ae4OvA8yaeB9Pfe0erpuaIAK4oNACwATgJYD/HwcpyvIXjODNYl4bldrtGHqzZ6XQZqs0NNKOE9azbbWXdbotrkK2LqelSKsbr7iWW95JraJzAumnUO0jtjjGizgI5ejroYzlRmWOFHghB+ikQbX9Y08pK/LwgqaaiP7+YP/z5XV4vh8cM06rSTfS9QPbgkuZqfEsXDw1rogtrNK7kTvVNvWmdS04y731ntJy6etG//vLAxtylRjm5VBuS5E6ruMVcy3w95w3NXN581NVaWCZTNhEYoabcnyK6ptyOkTIFevVEoXg8Vvt0dtSWnlYrb0bqtUnphe1HJFWxHbY1CLPPjinRyQ4lMFWRkpcZUYq15GW/5Rt/sCyhTHHUlN3ZxZb5TSvz0T2vF0OUVQPmtw9vdaiJWYaSzZrn0kxLwS6Xrw86TkezuRpVirV/GshUfhl7bJHCsQsbw862QrORyUnhof+DxafX7wt0tnuEWrv6S/Y2R0rv2m9oNm+nqb6nrfRXX4TIt0oZUSwRRfGKMDFRJcmqbkIQmHhUOpQKjh6JTUr3/gKMdM9hO+pHkgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"https://hadrienj.github.io/posts/Deep-Learning-Book-Series-2.1-Scalars-Vectors-Matrices-and-Tensors/\"\n        title=\"https://hadrienj.github.io/posts/Deep-Learning-Book-Series-2.1-Scalars-Vectors-Matrices-and-Tensors/\"\n        src=\"/static/9692699b1810f2dc434fb716b18b4f5b/37523/scalar%2Cvector%2Cmatrix%2Ctensor.png\"\n        srcset=\"/static/9692699b1810f2dc434fb716b18b4f5b/e9ff0/scalar%2Cvector%2Cmatrix%2Ctensor.png 180w,\n/static/9692699b1810f2dc434fb716b18b4f5b/f21e7/scalar%2Cvector%2Cmatrix%2Ctensor.png 360w,\n/static/9692699b1810f2dc434fb716b18b4f5b/37523/scalar%2Cvector%2Cmatrix%2Ctensor.png 720w,\n/static/9692699b1810f2dc434fb716b18b4f5b/d6a46/scalar%2Cvector%2Cmatrix%2Ctensor.png 1008w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n<em><a href=\"https://hadrienj.github.io/posts/Deep-Learning-Book-Series-2.1-Scalars-Vectors-Matrices-and-Tensors/\">https://hadrienj.github.io/posts/Deep-Learning-Book-Series-2.1-Scalars-Vectors-Matrices-and-Tensors/</a></em></p>\n<h3 id=\"functions\" style=\"position:relative;\"><a href=\"#functions\" aria-label=\"functions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Functions</h3>\n<ul>\n<li>\n<p><code class=\"language-text\">.ndim</code> : show dimension</p>\n<p>e.g.</p>\n<p><code class=\"language-text\">a.ndim</code> → 0</p>\n<p><code class=\"language-text\">b.ndim</code> → 1</p>\n<p><code class=\"language-text\">c.ndim</code> → 2</p>\n<p><code class=\"language-text\">d.ndim</code> → 3</p>\n</li>\n<li>\n<p><code class=\"language-text\">.shape</code> : show the number of values for each dimension</p>\n<p>e.g.</p>\n<p><code class=\"language-text\">a.shape</code> → ()</p>\n<p><code class=\"language-text\">b.shape</code> →(3,)</p>\n<p><code class=\"language-text\">c.shape</code> → (2,3)</p>\n<p><code class=\"language-text\">d.shape</code> → (2, 2, 3)</p>\n</li>\n</ul>\n<blockquote>\n<p>💡 <strong>NOTE :</strong> → 뒤는 **출력값(Output)**을 의미</p>\n</blockquote>\n<h2 id=\"2-define-numpy-arrays\" style=\"position:relative;\"><a href=\"#2-define-numpy-arrays\" aria-label=\"2 define numpy arrays permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Define Numpy arrays</h2>\n<ul>\n<li>\n<p>np.ones(<em>shape</em>) : define array given shape and fill with 1</p>\n<p>e.g. (10,) shape를 가지면서 1으로 채워진 배열을 정의</p>\n<p>usage :  <code class=\"language-text\">np.ones(10)</code></p>\n</li>\n<li>\n<p>np.zeros(<em>shape</em>) : define array given shape and fill with 0</p>\n<p>e.g. (2,5) shape를 가지면서 0으로 채워진 배열을 정의</p>\n<p>usage : <code class=\"language-text\">np.zeros((2,5))</code></p>\n</li>\n<li>\n<p>np.full(<em>shape, number</em>) :  define array given shape and fill with given number</p>\n<p>e.g. (2,5) shape를 가지면서 5로 채워진 배열을 정의</p>\n<p>usage : <code class=\"language-text\">np.full((2,5),5)</code></p>\n</li>\n<li>\n<p>np.random.random(<em>shape</em>) : define array given shape and fill with random numbers</p>\n<p>e.g. (2,3,4) shape를 가지는 랜덤 배열 정의</p>\n<p>usage :  <code class=\"language-text\">np.random.random((2, 3, 4))</code></p>\n</li>\n<li>\n<p>np.arange(<em>number</em>) : define array which contains 0 to given number-1 (similar to python <code class=\"language-text\">range()</code>)</p>\n<p>e.g. 0~9로 구성된 배열</p>\n<p>usage : <code class=\"language-text\">np.arrange(10)</code></p>\n<p>→ array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</p>\n<ul>\n<li>\n<p>np.arange(<em>number</em>).astype(<em>type</em>) : define arange() array given data type</p>\n<p>e.g. float 타입의 0~9로 구성된 배열</p>\n<p>usage : <code class=\"language-text\">np.arange(10).astype(float)</code></p>\n<p>→ array([0., 1., 2., 3., 4., 5., 6., 7., 8., 9.])</p>\n</li>\n<li>\n<p>np.arrange(<em>number</em>).reshape(<em>shape</em>) : define arange() array given shape</p>\n<p>e.g.(5, 2) shape를 가지면서 0~9로 구성된 배열</p>\n<p>usage : <code class=\"language-text\">np.arange(10).reshape((5,2))</code></p>\n<p>→ array([[0, 1],\n[2, 3],\n[4, 5],\n[6, 7],\n[8, 9]])</p>\n</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>💡 <strong>NOTE :</strong> shape를 명시할 때, shape가 2-by-3 이면, 괄호까지 포함해서 **(2,3)**로 명시하기! <br>         e.g. 🙅🏻‍♀️ <strong>np.ones(2,3)</strong>  🙆🏻‍♀️ <strong>np.ones((2,3))</strong></p>\n</blockquote>\n<h2 id=\"3-indexing--slicing\" style=\"position:relative;\"><a href=\"#3-indexing--slicing\" aria-label=\"3 indexing  slicing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Indexing &#x26; Slicing</h2>\n<p>python에서의 indexing &#x26; slicing 과 동일하게 작동한다.</p>\n<p>e.g. <code class=\"language-text\">a = np.arange(10)</code> <code class=\"language-text\">b = np.arange(9).reshape(3,3)</code></p>\n<ul>\n<li>\n<p>a[index] : access index of a, and index could be &#x3C; 0</p>\n<p>e.g. a의 0번째 인덱스에 있는 값</p>\n<p>usage : <code class=\"language-text\">a[0]</code> → 0</p>\n<p>e.g. a의 뒤에서 4번째에 있는 값</p>\n<p>usage : <code class=\"language-text\">a[-4]</code> → 6</p>\n<p>e.g. 마지막 row</p>\n<p>usage : <code class=\"language-text\">b[-1]</code> → [6 7 8]</p>\n<ul>\n<li>\n<p>Conditional indexing : 조건문에 따른 인덱싱 가능</p>\n<p>e.g. 짝수인 값만 출력</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">idx <span class=\"token operator\">=</span> b <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span>\n<span class=\"token comment\"># -> [[True False  True]</span>\n<span class=\"token comment\">#     [False  True False]</span>\n<span class=\"token comment\">#     [True False  True]]</span>\nb<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># -> [0 2 4 6 8]</span></code></pre></div>\n</li>\n<li>\n<p>Specific elements from a nd-array</p>\n<p>e.g. [0, 2, 3] index에 대한 값 출력 (vector)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">idx <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\na<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># [0 2 3]</span></code></pre></div>\n<p>e.g. [0, 2] 행 혹은 열에 해당하는 값 출력 (tensor)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">idx <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># row</span>\nb<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># -> [[0 1 2]</span>\n<span class=\"token comment\">#     [6 7 8]]</span>\n\n<span class=\"token comment\"># column</span>\nb<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span>idx<span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># -> [[0 2]</span>\n<span class=\"token comment\">#     [3 5]</span>\n<span class=\"token comment\">#     [6 8]]</span></code></pre></div>\n<p>e.g. [[0,0,1],[1,2,0]]에 해당하는 값 출력 (tuple 형태도 가능)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">idx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># tuple : idx = ((0,0,1),(1,2,0))</span>\nb<span class=\"token punctuation\">[</span>idx<span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># -> [[[0 1 2]</span>\n<span class=\"token comment\">#      [0 1 2]</span>\n<span class=\"token comment\">#      [3 4 5]]</span>\n<span class=\"token comment\">#     [[3 4 5]</span>\n<span class=\"token comment\">#      [6 7 8]</span>\n<span class=\"token comment\">#      [0 1 2]]]</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>a[<em>start index</em>:<em>end index</em>:<em>interval</em>] : access from start index to end index - 1 with interval, and interval could be &#x3C; 0</p>\n<p>e.g. 2번째부터 4번째 인덱스에 있는 값</p>\n<p>usage : <code class=\"language-text\">a[2:5]</code> → [2 3 4]</p>\n<p>e.g. 0번째부터 10번째 인덱스 이전까지 있는 값을 3을 간격으로 출력</p>\n<p>usage : <code class=\"language-text\">a[0:10:3]</code> → [0 3 6 9]</p>\n<p>e.g.  8번째부터 5번째 인덱스 다음까지 있는 값을 -1을 간격으로 출력</p>\n<p>usage : <code class=\"language-text\">a[8:5:-1]</code> → [8 7 6]</p>\n<p>e.g. 두번째 column</p>\n<p>usage : <code class=\"language-text\">b[:,1]</code> → [1 4 7]</p>\n</li>\n</ul>\n<h2 id=\"4-math-operations\" style=\"position:relative;\"><a href=\"#4-math-operations\" aria-label=\"4 math operations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Math Operations</h2>\n<ul>\n<li>\n<p>Element-wise operation</p>\n<ul>\n<li>\n<p>+, - , x, / : given two numpy arrays should have same shape</p>\n<p>e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>full<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> [[2 3]</span>\n<span class=\"token comment\">#     [4 5]</span>\n<span class=\"token comment\">#     [6 7]]</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">-</span>b<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> [[-2 -1]</span>\n<span class=\"token comment\">#     [ 0  1]</span>\n<span class=\"token comment\">#     [ 2  3]]</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">*</span>b<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> [[ 0  2]</span>\n<span class=\"token comment\">#     [ 4  6]</span>\n<span class=\"token comment\">#     [ 8 10]]</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">/</span>b<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> [[0.  0.5]</span>\n<span class=\"token comment\">#     [1.  1.5]</span>\n<span class=\"token comment\">#     [2.  2.5]]</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>Unary operation</p>\n<p>e.g. <code class=\"language-text\">a = np.arange(6).reshape((3,2))</code></p>\n<ul>\n<li>\n<p>a.sum(axis) : get sum of a regarding axis (axis is optional)</p>\n<p>usage : <code class=\"language-text\">a.sum()</code> → 15</p>\n<p>e.g. axis 0에 대한 sum (row-wise)</p>\n<p>usage : <code class=\"language-text\">a.sum(axis=0)</code> → [6 9]</p>\n<p>e.g. axis 1에 대한 sum (column-wise)</p>\n<p>usage : <code class=\"language-text\">a.sum(axis=1)</code> → [1 5 9]</p>\n</li>\n<li>\n<p><code class=\"language-text\">a.mean()</code> : get mean of a → 2.5</p>\n</li>\n<li>\n<p><code class=\"language-text\">a.max()</code> : get maximum value of a → 5</p>\n</li>\n<li>\n<p><code class=\"language-text\">a.min()</code> : get minimum value of a → 0</p>\n</li>\n</ul>\n</li>\n<li>\n<p>Dot product, Multiplication</p>\n<p>e.g.</p>\n<p>vector : <code class=\"language-text\">a = np.arange(3).astype('float')</code> <code class=\"language-text\">b = np.ones(3)</code></p>\n<p>matrix : <code class=\"language-text\">a = np.arange(6).reshape((3, 2))</code> <code class=\"language-text\">b = np.arange(6).reshape((2, 3))</code></p>\n<p>tensor : <code class=\"language-text\">a = np.arange(24).reshape((4, 3, 2))</code> <code class=\"language-text\">b = np.ones((4, 2, 3))</code></p>\n<ul>\n<li>\n<p>Dot product</p>\n<p>usage : <code class=\"language-text\">np.dot(a, b)</code></p>\n<ul>\n<li>vector : <code class=\"language-text\">np.dot(a, b)</code> → 3.0</li>\n<li>matrix : <code class=\"language-text\">np.dot(a, b).shape</code> → (3, 3)</li>\n<li>tensor : <code class=\"language-text\">np.dot(a, b).shape</code> → (4, 3, 4, 3)</li>\n</ul>\n</li>\n<li>\n<p>Mutiplication</p>\n<p>usage : <code class=\"language-text\">a@b</code></p>\n<ul>\n<li>vector : <code class=\"language-text\">a@b</code> → 3.0</li>\n<li>matrix : <code class=\"language-text\">(a@b).shape</code> → (3, 3)</li>\n<li>tensor : <code class=\"language-text\">(a@b).shape</code> → (4, 3, 3)</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"5-shape-manipulation\" style=\"position:relative;\"><a href=\"#5-shape-manipulation\" aria-label=\"5 shape manipulation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Shape Manipulation</h2>\n<ul>\n<li>\n<p>Reshape</p>\n<p>usage : <code class=\"language-text\">a.reshape(shape)</code></p>\n<ul>\n<li>shape 에서 -1 은 주어진 수가 있을 경우, 현재 shape에서 주어진 수만큼의 모양을 가지고 남는 차원으로 할당하고, 주어진 수가 없을 경우, 1차원 배열로 만든다. 그리고 -1을 통해 가능한 차원 추가는 한 차원 추가만 가능하다.</li>\n</ul>\n<p>e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\nc <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># b와 c의 shape는 (6,4)로 동일</span>\nd <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># d의 shape는 (6, 4, 1)이 됨</span>\n<span class=\"token comment\"># d = a.reshape((6,4,-1,-1)) -> ValueError: can only specify one unknown dimension</span>\ne <span class=\"token operator\">=</span> b<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># e의 shape는 a에서의 shape와 동일하게 (24,)가 됨</span></code></pre></div>\n</li>\n<li>\n<p>Add an extra dimension</p>\n<p>usage : <code class=\"language-text\">a[:, None]</code></p>\n<ul>\n<li>차원 추가하기 원하는 부분에 None을 입력하고, 기존 값들은 [:] slicing을 통해 복사</li>\n</ul>\n<p>e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> (3,)</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> [[0]</span>\n<span class=\"token comment\">#     [1]</span>\n<span class=\"token comment\">#     [2]]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> (3, 1)</span>\nc <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> [0 1 2]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> (1, 3)</span>\nd <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> (3, 1, 1)</span></code></pre></div>\n</li>\n<li>\n<p>Stack, concatenation</p>\n<ul>\n<li>\n<p>vstack : stack vertically</p>\n<p>usage : <code class=\"language-text\">np.vstack(tuple)</code></p>\n</li>\n<li>\n<p>hstack : stack horizontally</p>\n<p>usage : <code class=\"language-text\">np.vstack(tuple)</code></p>\n</li>\n<li>\n<p>concatenate : concatenate on axis (default axis = 0)</p>\n<p>usage : <code class=\"language-text\">np.concatenate(tuple, axis)</code></p>\n<ul>\n<li>axis = 0 이면 vstack의 결과와 동일하고, axis = 1 이면 hstack의 결과와 동일</li>\n<li>axis = None 이면 1차원으로 만들어버림</li>\n<li>axis 에 해당하는 dimension을 제외하고 무조건 나머지 input dimension은 동일해야 함!</li>\n</ul>\n</li>\n</ul>\n<p>e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>vstack<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> [[1. 1.]</span>\n<span class=\"token comment\">#     [1. 1.]</span>\n<span class=\"token comment\">#     [1. 1.]</span>\n<span class=\"token comment\">#     [0. 0.]</span>\n<span class=\"token comment\">#     [0. 0.]</span>\n<span class=\"token comment\">#     [0. 0.]]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>hstack<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> [[1. 1. 0. 0.]</span>\n<span class=\"token comment\">#     [1. 1. 0. 0.]</span>\n<span class=\"token comment\">#     [1. 1. 0. 0.]]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>hstack<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> [[1. 1. 0. 0. 1. 1.]</span>\n<span class=\"token comment\">#     [1. 1. 0. 0. 1. 1.]</span>\n<span class=\"token comment\">#     [1. 1. 0. 0. 1. 1.]]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>concatenate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> [[1. 1.]</span>\n<span class=\"token comment\">#     [1. 1.]</span>\n<span class=\"token comment\">#     [1. 1.]</span>\n<span class=\"token comment\">#     [0. 0.]</span>\n<span class=\"token comment\">#     [0. 0.]</span>\n<span class=\"token comment\">#     [0. 0.]]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>concatenate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># -> [[1. 1. 0. 0.]</span>\n<span class=\"token comment\">#     [1. 1. 0. 0.]</span>\n<span class=\"token comment\">#     [1. 1. 0. 0.]]</span>\n\na <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nnp<span class=\"token punctuation\">.</span>concatenate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> ValueError</span>\n\na <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nnp<span class=\"token punctuation\">.</span>concatenate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>a<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>shape <span class=\"token comment\"># -> (4,3,9)</span></code></pre></div>\n</li>\n<li>\n<p>Transpose</p>\n<ul>\n<li>\n<p>Matrix transpose</p>\n<p>usage : <code class=\"language-text\">a.T</code></p>\n<p>e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>T\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> (2, 3)</span></code></pre></div>\n</li>\n<li>\n<p>Tensor transpose</p>\n<p>usage : <code class=\"language-text\">np.transpose(a, axes)</code></p>\n<ul>\n<li>axes : 전체 axis 갯수의 tuple or list of ints 로, 원하는 순서의 axis 들의 나열</li>\n</ul>\n<p>e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">a <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> (4, 2, 3)</span>\nc <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> (3, 4, 2)</span></code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"6-broadcasting\" style=\"position:relative;\"><a href=\"#6-broadcasting\" aria-label=\"6 broadcasting permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Broadcasting</h2>\n<p>Broadcasting : 두 배열이 다른 shape를 가지더라도 두 배열의 shape가 조건을 만족한다면, 둘 중 더 작은 dimension이 더 큰 dimension을 가지도록 만들어서 사칙연산이 가능하도록 하는 것을 말한다.</p>\n<ul>\n<li>조건 : 동일한 dimension이거나 1이어야 한다.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 520px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB+UlEQVQozzWRTWgTQRzF3y6YQ0Ww6kEUEW8GtLQWiyjSkye9eNMgIjmIJw9BSbEX04Me7DGn5NYmkKKQkEsihb2Yb9JuM5lsul/dDflgE9NCaNJ2RRiZUgeGgffn9/6PN0gmk0ilUgAgArjKGEM4HEZoZUXIFYv4VSiAawAu83ctFsOn5WUxGAz+168BuAngCoBz8Hq9HlmWvxJCvhNC1imlPxKJxKNIJILPodCUurf3pdvvr09cN3p4fLzWHw7v/dzcxLfV1Yu1Wi1MCNlQFCVer9c3otHoHZRKpSeDwYDZts263S5rtVpMluV3h5MJqjs7z612m42Ojtj45ISNXZftj0aveTJCiL/dbjPHcVin02G9Xo8VCoWnkGX52XA4ZJqmjW3b/tNsNn+n0+n5g9EIRFFe6pbFzVxuOHHdQc9xZrghpfStqqo8xNiyrL+appmxWOwGT3hB1/VZSumMaZpzkiTd4sD7QACV7e1purv7oL9/MN9xnIeVra3bimHgQyDAuWlK6ayqqncty5rLZDLXTzstl8swDINvhGmakCTptOzHi4vCx6UlXvoUAC+AS1zn95XPJ1QqlVNG0zRYloVsNstnAorFIjcSKaWirutiLpcTcHY4/MLn89xfWDj/xu/3nP0q4vE4qtUqGo2GaBiGyPl8Pi/w+T/hi1fSk4PECQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"https://numpy.org/doc/stable/user/basics.broadcasting.html\"\n        title=\"https://numpy.org/doc/stable/user/basics.broadcasting.html\"\n        src=\"/static/947683ff36cd4ea2a3142a44606f44d4/69902/broadcasting_example.png\"\n        srcset=\"/static/947683ff36cd4ea2a3142a44606f44d4/e9ff0/broadcasting_example.png 180w,\n/static/947683ff36cd4ea2a3142a44606f44d4/f21e7/broadcasting_example.png 360w,\n/static/947683ff36cd4ea2a3142a44606f44d4/69902/broadcasting_example.png 520w\"\n        sizes=\"(max-width: 520px) 100vw, 520px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n<em><a href=\"https://numpy.org/doc/stable/user/basics.broadcasting.html\">https://numpy.org/doc/stable/user/basics.broadcasting.html</a></em></p>\n<p>e.g.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Vector and scalar</span>\na <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">.</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> [2. 3. 4.]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">-</span>b<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> [-2. -1.  0.]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">*</span>b<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> [0. 2. 4.]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">/</span>b<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> [0.  0.5 1. ]</span>\n\n<span class=\"token comment\"># Matrix and vector</span>\na <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> (3, 2)</span>\n\n<span class=\"token comment\"># Tensor and matrix</span>\na <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> (2, 3, 2)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># -> (2, 3, 2)</span></code></pre></div>\n<h2 id=\"quiz--fill-the-function-code-classlanguage-textfoocode\" style=\"position:relative;\"><a href=\"#quiz--fill-the-function-code-classlanguage-textfoocode\" aria-label=\"quiz  fill the function code classlanguage textfoocode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Quiz : Fill the function <code class=\"language-text\">foo()</code></h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">sigmoid</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">.</span> <span class=\"token operator\">+</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t<span class=\"token comment\"># Define a function that, given M of shape (m,n) and W of shape (4n, n), executes the following:</span>\n\t<span class=\"token comment\"># - Take the first half rows of M</span>\n\t<span class=\"token comment\"># - Take the second half rows of M</span>\n\t<span class=\"token comment\"># - Take the odd-numbered rows of M</span>\n\t<span class=\"token comment\"># - Take the even-numbered rows of M</span>\n\t<span class=\"token comment\"># - Append them horizontally in the listed order so that you obtain a matrix X of shape (?, 4n)</span>\n\t<span class=\"token comment\"># - Linearly transform X with W so that you obtain a matrix Y of shape (?, ?)</span>\n\t<span class=\"token comment\"># - Put Y through the sigmoid function</span>\n\t<span class=\"token comment\"># - Obtain the sum of the row-wise mean</span>\n\t\nW <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">10</span><span class=\"token punctuation\">.</span>\nM <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">10</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">10</span><span class=\"token punctuation\">.</span>\n\nfoo<span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span></code></pre></div>\n<details>\n<summary>Answer</summary>\n<div markdown=\"1\">\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">   <span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n   \n   <span class=\"token keyword\">def</span> <span class=\"token function\">sigmoid</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n       <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">.</span><span class=\"token operator\">/</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">.</span> <span class=\"token operator\">+</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n   \n   <span class=\"token keyword\">def</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n     <span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">,</span> col<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> M<span class=\"token punctuation\">.</span>shape\n     first_half_rows <span class=\"token operator\">=</span> M<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>row<span class=\"token operator\">//</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n     second_half_rows <span class=\"token operator\">=</span> M<span class=\"token punctuation\">[</span>row<span class=\"token operator\">//</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n     odd_num_rows <span class=\"token operator\">=</span> M<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n     even_num_rows <span class=\"token operator\">=</span> M<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n     X <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>hstack<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>first_half_rows<span class=\"token punctuation\">,</span> second_half_rows<span class=\"token punctuation\">,</span> odd_num_rows<span class=\"token punctuation\">,</span> even_num_rows<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n     <span class=\"token comment\"># X = np.concatenate([first_half_rows, second_half_rows, odd_num_rows, even_num_rows], axis=1)</span>\n     Y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>dot<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span>\n     sigmoid_Y <span class=\"token operator\">=</span> sigmoid<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">)</span>\n     row_wise_mean <span class=\"token operator\">=</span> sigmoid_Y<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span>axis<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n     <span class=\"token keyword\">return</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>row_wise_mean<span class=\"token punctuation\">)</span>\n   \n   W <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">10</span><span class=\"token punctuation\">.</span>\n   M <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">'float'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">10</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">10</span><span class=\"token punctuation\">.</span>\n   \n   foo<span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">,</span> W<span class=\"token punctuation\">)</span></code></pre></div>\n</div>\n</details>\n<br>\n<p>👉🏼  관련 실습 코드 : <a href=\"https://github.com/Sunkyoung/PyTorch-Study/blob/main/PyTorch_Study_01_NumPy.ipynb\">https://github.com/Sunkyoung/PyTorch-Study/blob/main/PyTorch_Study_01_NumPy.ipynb</a></p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#0-numpy\">0. NumPy</a></p>\n</li>\n<li>\n<p><a href=\"#1-numpy-array-data\">1. NumPy array data</a></p>\n<ul>\n<li><a href=\"#functions\">Functions</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-define-numpy-arrays\">2. Define Numpy arrays</a></p>\n</li>\n<li>\n<p><a href=\"#3-indexing--slicing\">3. Indexing &#x26; Slicing</a></p>\n</li>\n<li>\n<p><a href=\"#4-math-operations\">4. Math Operations</a></p>\n</li>\n<li>\n<p><a href=\"#5-shape-manipulation\">5. Shape Manipulation</a></p>\n</li>\n<li>\n<p><a href=\"#6-broadcasting\">6. Broadcasting</a></p>\n</li>\n<li>\n<p><a href=\"#quiz--fill-the-function-foo\">Quiz : Fill the function <code class=\"language-text\">foo()</code></a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"January 10, 2022","title":"Review AI504 Practice Session - 01 NumPy","categories":"Deeplearning","author":"선경","emoji":"🔥"},"fields":{"slug":"/pytorch-study-01/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://sunkyoung.github.io","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/pytorch-study-02/","nextSlug":"/pytorch-study-01/","prevSlug":""}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}